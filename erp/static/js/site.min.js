$.validator&&$.validator.setDefaults({ignore:'input[type="hidden"], .tt-hint, .ignore',onkeyup:!1}),function(){for(var e,t=function(){},a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=a.length,i=window.console=window.console||{};n--;)e=a[n],i[e]||(i[e]=t);Number.prototype.toFormattedString=function(e){return e||(e=2),this>=0?this.toFixed(e).replace(/\d(?=(\d{3})+\.)/g,"$&,"):"("+Math.abs(this).toFixed(e).replace(/\d(?=(\d{3})+\.)/g,"$&,")+")"},Array.prototype.remove=function(e){var t=this.indexOf(e);-1!==t&&this.splice(t,1)}}(),function(e){e.fn.clickToggle=function(t,a){return this.each(function(){var n=!1;e(this).bind("click",function(){return n?(n=!1,a.apply(this,arguments)):(n=!0,t.apply(this,arguments))})})},e.fn.autoComplete=function(){e.each(this,function(){var t=e(this),a=t.closest(".edit-cell"),n="Id",i="Name",o=t.data("model"),s=t.data("url"),d=t.data("init");if(!(t.find(".twitter-typeahead").length>0))if(a.length>0&&e(this).css("width",a.width()),d)window[d]&&window[d](t);else{var l=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("Name"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:s,wildcard:"%QUERY",ajax:{headers:{Accept:"application/json; charset=utf-8","Content-Type":"text/plain; charset=utf-8"}},filter:function(t){return t["@odata.context"]?e.map(t.value,function(e){return{Id:e.Id,Name:e.Name}}):t}}});t.find(".typeahead").typeahead({hint:!0,highlight:!0,minLength:1},{displayKey:i,source:l}).on("typeahead:selected",function(a,s){var d="";null!=o&&(d="#"+o.replace(".","_"),t.find(d).val(s[n])),""!==d&&e(d).trigger("autocomplete:selected",[t,{Id:s[n],Name:s[i]}])})}})},e.fn.simulateLoading=function(){e(this).append(e("<div/>",{"class":"loading",text:"Loading&hellip;"}))},e.fn.autoGrowInput=function(t){return t=e.extend({maxWidth:1e3,minWidth:0,comfortZone:50},t),this.filter("input:text").each(function(){var a=t.minWidth||e(this).width(),n="",i=e(this),o=e("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),s=function(){if(n!==(n=i.val())){var e=n.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");o.html(e);var s=o.width(),d=s+t.comfortZone>=a?s+t.comfortZone:a,l=i.width(),r=l>d&&d>=a||d>a&&d<t.maxWidth;r&&i.width(d)}};o.insertAfter(i),e(this).bind("keyup keydown blur update",s)}),this},e.fn.attachGridPlugins=function(){var t=e(document),a=e(this).find("#form-grid"),n=e("div.searchbox"),i=function(){n.find("input").css({textIndent:n.find(".tags").width()})},o=function(t){var a=e(t).data("tag"),n=a.split(":"),i=n[0].toLowerCase(),o=n[1].trim(),s=e("<span>",{"class":"tag label","data-tag-type":i,"data-tag-value":o}).text(a).append(e("<span>",{"data-role":"remove"}));return s},s=function(e){e.remove(),i(),l(),a.submit()},d=function(t){for(var a=e(t).attr("class").split(" "),n=0;n<a.length;n++)if(/^label/.test(a[n]))return a[n];return"label-info"},l=function(){var t=n.find(".tag"),i=a.find("#search-params");i.html(null),t.each(function(){var t=e("<input>",{type:"hidden",name:e(this).data("tagType"),value:e(this).data("tagValue")});i.append(t)})};t.on("click","div.searchbox",function(){e(this).addClass("focus"),e(this).find("input").focus()}),t.on("focusout","div.searchbox",function(){e(this).removeClass("focus")}),t.on("click","div.searchbox [data-role=remove]",function(){s(e(this).closest(".tag"))}),t.on("click",".inbox-left-menu .tags li a[data-remove-tag]",function(t){t.preventDefault();var a=n.find(".tags"),i=e(this).data("removeTag").toLowerCase(),o=a.find("[data-tag-type="+i+"]");s(o)}),t.on("click",".inbox-left-menu .tags li a[data-tag]",function(t){t.preventDefault();var s=o(this),r=s.data("tagType"),c=n.find(".tags"),f=c.find("[data-tag-type="+r+"]"),u=d(e(this).closest("li").find("i"));s.addClass(u),f.length>0&&f.remove(),c.append(s),i(),l(),a.submit()}),t.on("click","#refresh",function(){a.submit()}),t.on("click",".inbox-nav-toggle",function(){e(".inbox-left-menu").toggleClass("active")}),t.on("click",".pager li > a",function(t){if(t.preventDefault(),!e(this).hasClass("disabled")){var n=e(this).find("i"),i=n.hasClass("fa-angle-left")?-1:n.hasClass("fa-angle-right")?1:0,o=e(this).closest(".pager"),s=parseInt(o.data("currentpage"))+i,d=a.attr("action");e(".messages").simulateLoading(),a.ajaxSubmit({type:"POST",url:d,data:{page:s},success:function(t){e(".inbox-content").html(t)}})}}),t.on("change",".message-table .fancy-checkbox",function(t){t.stopPropagation(),e(this).find(":checkbox").is(":checked")?e(this).parents("tr").addClass("highlighted"):e(this).parents("tr").removeClass("highlighted"),e(".message-table tr.highlighted").length>0?(e(".top-menu .context-menu").removeClass("hide"),e(".top-menu .toggle-menu").addClass("hide")):(e(".top-menu .context-menu").addClass("hide"),e(".top-menu .toggle-menu").removeClass("hide")),e(".top-menu .fancy-checkbox-all").find(":checkbox").prop("checked",0===e(".message-table tr:not(.highlighted)").length)}),t.on("change",".top-menu .fancy-checkbox-all",function(){var t=e(".message-table tr:not(.empty-row)");0!=t.length&&(e(this).find(":checkbox").is(":checked")?(t.find(".fancy-checkbox>:checkbox").prop("checked",!0),t.addClass("highlighted"),e(".top-menu .context-menu").removeClass("hide"),e(".top-menu .toggle-menu").addClass("hide")):(t.find(".fancy-checkbox>:checkbox").prop("checked",!1),t.removeClass("highlighted"),e(".top-menu .context-menu").addClass("hide"),e(".top-menu .toggle-menu").removeClass("hide")))}),t.on("click",".status-update",function(t){var n=e(this).data("status"),i=e(this).closest(".dropdown-menu"),o=e(this).closest("[data-url]"),s=o.data("url"),d=e(".message-table tr.highlighted");if(t.preventDefault(),i.length>0&&o.closest(".open").removeClass("open"),d.length>0&&confirm("This will update "+d.length+" record(s) to "+n.toUpperCase()+" status.\n Confirm action?")){var l={status:n};e.each(d,function(t,a){l["id-"+t]=e(this).data("uid")}),e(".messages").simulateLoading(),a.ajaxSubmit({type:"POST",url:s,data:l,success:function(t){e(".inbox-content").html(t)}})}})},e.fn.serializeObject=function(t){var a={},n=this.serializeArray();return e.each(n,function(){var e=this.name;t&&(e=t(e)),void 0!==a[e]?(a[e].push||(a[e]=[a[e]]),a[e].push(this.value||"")):a[e]=this.value||""}),a},e.fn.attachFormPlugins=function(){var t,a;return e.fn.multiselect&&e(".multiselect").multiselect({inheritClass:!0}),e.fn.select2&&(t=e(".select2"),a=t.data("options")||{},a.width="100%",t.select2(a)),e.fn.datetimepicker&&(getOptions=function(e){var t=e.data(),a={};for(var n in t)if(/^options/.test(n)){var i=n.replace(/^options/,"").toLowerCase();a[i]=t[n]}return a},t=e(".input-daterange"),t.length>0&&t.find("input").datetimepicker(getOptions(t)),t=e(".datetimepicker"),t.length>0&&t.datetimepicker(getOptions(t))),e.fn.summernote&&e(".summernote").summernote({toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough","superscript","subscript"]],["fontsize",["fontname","fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]]],height:300,onBlur:function(){var t="#"+e(this).data("input");e(t).val(e(this).code())}}),e.fn.autoComplete&&e(".autocomplete").autoComplete(),this},e.fn.attachFormEvents=function(){return 0!=e(this).length?(e(document).on("click",".top-menu .cancel > a",function(e){confirm("You have chosen to cancel data entry. Confirm action?")||e.preventDefault()}),e(document).on("click",".inbox-nav-toggle",function(){e(".inbox-left-menu").toggleClass("active")}),e(document).on("click",".left-menu li a",function(){e(".left-menu li .fa").removeClass("fa-folder-open").addClass("fa-folder-o"),e(this).find(".fa").removeClass("fa-folder-o").addClass("fa-folder-open"),e(".inbox-left-menu").toggleClass("active")}),e(document).on("click",".sub-form a[data-cmd]",function(t){var a=e(this).data("cmd"),n=e(this).closest(".row"),i=e(this).closest(".container"),o=i.data("formUrl");switch(t.preventDefault(),a){case"add":var s={};i.find(".row").length&&(s.row_id=i.find(".display-row").length),e.ajax({type:"GET",url:o,data:s,success:function(e){i.append(e),i.find(".empty-row").addClass("hidden")}});break;case"delete":""===n.find("input[id$=id]").val()?n.remove():n.find("input[id$=deleted]").val("yes"),n.addClass("hidden"),0===i.find(".display-row:not(.hidden)").length&&i.find(".empty-row").removeClass("hidden")}}),e(document).on("change",".inbox.new-message .settings .onoffswitch input[type=checkbox]",function(){var t=(e(this).is(":checked"),e(this).attr("id").replace("switch-","")),a=e(this).closest(".settings"),n=a.find(".settings-values"),i=n.find(".settings-item[id$="+t+"]");if(e(this).is(":checked"))if(i.length>0)i.find("[id$=deleted]").val("no");else{var o=n.find(".settings-item").length,s=a.data("formUrl");e.ajax({type:"GET",url:s,data:{row_id:o,id:t},success:function(e){n.append(e)}})}else i.length>0&&i.find("[id$=deleted]").val("yes")}),e(document).on("click",".table-menu [data-cmd=add], table .display-row td:not(.table-menu)",function(t){var a=e(this).closest(".tab-pane"),n=a.find("table"),i=n.find("tbody"),o=e(this).data("cmd"),s=e(this).closest("tr.display-row"),d=s.data("rowId"),l={};t.preventDefault(),"add"===o?d=i.find("tr:not(.empty-row)").length:l=s.find("input").serializeObject(function(e){return e.replace(/^([\w\-\d]+\.)/,"")}),l.row_id=d,l._csrf=e("#_csrf").val(),e.ajax({type:"POST",url:n.data("formUrl"),data:l,success:function(t){-1!==t.indexOf("</tr>")?(i.find(".empty-row").addClass("hidden"),"add"===o?i.append(t):(s.addClass("hidden"),e(t).insertAfter(s))):(n.hide(),a.append(t)),a.find(".table-form").validate()}})}),e(document).on("click",".table-menu [data-cmd=update]",function(t){var a=e(this).closest(".tab-pane"),n=a.find("table"),i=n.find("tbody"),o=e(this).closest(".table-form"),s=e(this).closest(".edit-row"),d=o.data("rowId"),l=i.find(".display-row[data-row-id="+d+"]");t.preventDefault(),o.valid()&&o.ajaxSubmit({type:"POST",beforeSubmit:function(){o.simulateLoading()},success:function(e){o.remove(),s.remove(),0===l.length?i.append(e):l.replaceWith(e),i.find(".empty-row").addClass("hidden"),n.show()}})}),e(document).on("click",".table-menu [data-cmd=cancel]",function(t){var a=e(this).closest(".tab-pane"),n=a.find("table"),i=n.find("tbody"),o=e(this).closest(".table-form"),s=e(this).closest(".edit-row"),d=o.data("rowId"),l=i.find(".display-row[data-row-id="+d+"]");t.preventDefault(),o.remove(),s.remove(),l.removeClass("hidden"),n.show(),0===i.find(".display-row:not(.hidden)").length&&i.find(".empty-row").removeClass("hidden")}),e(document).on("click",".table-menu [data-cmd=delete]",function(t){var a=e(this).closest(".tab-pane"),n=a.find("table"),i=n.find("tbody"),o=e(this).data("rowId"),s=i.find("tr[data-row-id="+o+"]"),d=s.find("input[id$=deleted]");t.preventDefault(),d.val("yes"),s.removeClass("edit-row").addClass("hidden"),a.find(".table-form").remove(),n.show(),0===i.find(".display-row:not(.hidden)").length&&i.find(".empty-row").removeClass("hidden")}),this):void 0}}(jQuery),$(function(){$(".main-menu .js-sub-menu-toggle").click(function(e){e.preventDefault();var t=$(this).parent("li");t.hasClass("active")?(t.find(" > a .toggle-icon").removeClass("fa-angle-down").addClass("fa-angle-left"),t.removeClass("active")):(t.find(" > a .toggle-icon").removeClass("fa-angle-left").addClass("fa-angle-down"),t.addClass("active")),t.find(" > .sub-menu").slideToggle(300)}),$(".js-toggle-minified").clickToggle(function(){$(".left-sidebar").addClass("minified"),$(".content-wrapper").addClass("expanded"),$(".left-sidebar .sub-menu").css("display","none").css("overflow","hidden"),$(".main-menu > li > a > .text").animate({opacity:0},200),$(".sidebar-minified").find("i.fa-angle-left").toggleClass("fa-angle-right")},function(){$(".left-sidebar").removeClass("minified"),$(".content-wrapper").removeClass("expanded"),$(".main-menu > li > a > .text").animate({opacity:1},600),$(".sidebar-minified").find("i.fa-angle-left").toggleClass("fa-angle-right")}),$(".main-nav-toggle").clickToggle(function(){$(".left-sidebar").slideDown(300)},function(){$(".left-sidebar").slideUp(300)}),$(window).on("resize",function(){var e=$(".left-sidebar");$(window).width()<977?e.hasClass("minified")&&e.removeClass("minified").addClass("init-minified"):e.hasClass("init-minified")&&e.removeClass("init-minified").addClass("minified")}),$("body").tooltip({selector:"[data-toggle=tooltip]"}),$(".alert").length>0&&$(".alert .close").click(function(e){e.preventDefault(),$(this).parents(".alert").fadeOut(300)});var e=$("#form-grid");e.length>0&&(e.ajaxForm({beforeSubmit:function(){$(".messages").simulateLoading()},success:function(e){$(".inbox-content").html(e)}}),$(".inbox.grid").attachGridPlugins());var t=$("#form-entry");if(t.length>0){var a=$(".inbox.new-message"),n=t.find("#submit"),i=n.data("gritterTitle");t.validate(),t.ajaxForm({beforeSubmit:function(){a.simulateLoading()},success:function(e){a.html(e).attachFormPlugins(),a.find("ul.error>li").length?$.gritter.add({title:i,text:"An error occured while saving to database."}):$.gritter.add({title:i,text:"Record has been successfully saved."})}}),a.attachFormPlugins(),a.attachFormEvents()}});