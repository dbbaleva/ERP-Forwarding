<tal:block metal:define-macro="header">
    <link href="${request.static_url('erp:lib/bootstrap-datetimepicker.min.css')}" rel="stylesheet">
    <link href="${request.static_url('erp:lib/select2.min.css')}" rel="stylesheet">
    <link href="${request.static_url('erp:lib/summernote.min.css')}" rel="stylesheet">
    <link href="${request.static_url('erp:static/css/site.css')}" rel="stylesheet">
    <style type="text/css">
        .note-color .btn-group .dropdown-menu {
            right: 0;
            left: auto;
        }
    </style>
</tal:block>

<tal:block metal:define-macro="footer">
    <script src="${request.static_url('erp:lib/jquery.validate.min.js')}"></script>
    <script src="${request.static_url('erp:lib/moment.min.js')}"></script>
    <script src="${request.static_url('erp:lib/bootstrap-datetimepicker.min.js')}"></script>
    <script src="${request.static_url('erp:lib/select2.min.js')}"></script>
    <script src="${request.static_url('erp:lib/summernote.min.js')}"></script>
    <script src="${request.static_url('erp:static/js/site.js')}"></script>

    <script type="text/javascript">
        $(function() {
            var height = $(".new-message-form").height() - 70; // less padding+toolbarheight
            $("[data-input=remarks]").summernote({
                toolbar: [
                    //[groupname, [button list]]
                    ["style", ["bold", "italic", "underline", "clear"]],
                    ["font", ["strikethrough", "superscript", "subscript"]],
                    ["fontsize", ["fontname", "fontsize"]],
                    ["color", ["color"]],
                    ["para", ["ul", "ol", "paragraph"]],
                    ["height", ["height"]]
                ],
                height: height,
                onBlur: function () {
                    var fld = "#" + input.data("input");
                    $(fld).val($(this).code());
                }
            });

            $(document).on(
                "select2:select",
                "#company_id",
                function(e) {
                    var data = e.params.data;
                    var contact = $("#contact_id");
                    var url = contact.data("url");

                    $.ajax({
                        url: url,
                        data: {
                            id: data.id
                        },
                        success: function(result) {
                            contact.replaceWith(result);
                        }
                    })
                }
            );
        });
    </script>
</tal:block>